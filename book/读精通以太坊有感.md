#  读精通以太坊有感

- 以太坊是一个确定无状态的自动机
- 通过gas来现在过度使用资源执行程序，但是用户是怎么评判执行给定的程序需要的gas量呢？万一不够就完全完蛋了，程序没执行完，钱还没了，还是说只要每次给过量的，等待退款就可以了。
- 两种账户：
  - 外部账户：存在私钥，可以主动发起交易
  - 合约账户：无私钥，不可以主动交易，但是可以响应合约内容来发起请求
- 创建合约账户的过程中，合约代码是不执行的，执行操作在后面的交易。在这个过程中，合约可能按照代码发起内部交易。创建合约账户的过程中，给的目标地址是0地址，但是创建之后会返回一个合约账户地址，后面就用这个账户进行交易。
- 远程客户端和SPV功能相似，但是远程客户端完全信任全节点提供的信息，不对区块头做验证，所以安全性可能会有一些问题
- 进一步明确了公钥可以被私钥推出来，不过应该仅限于ECC，需要后面看看该算法
- HD钱包助记词的生成：
  - 首先生成一个长度为128或者256的随机数，然后进行sha-256哈希，再将hash的前（随机数长度/32）位加到随机数后面进行拼接，接着每11位进行分割，然后查表，有一个包含11位所有可能的表，每一个值都对应一个简单的单词，由此生成了所有的单词。
- 种子密钥的生成：
  - 使用之前生成的助记词和一个用户决定的盐值经过密钥拓展算法生成长度为512位的种子密钥
- 子公钥有两种生成方式，一种是父公钥推导，另一种是子私钥推导，这两种效果是一样的，很神奇
- nonce值的两大使用场景：
  - 一是保证交易的先后性，只有序号较小的nonce交易被处理完成才会处理大的交易，这样就可以忽略网络传播延时的问题
  - 二是防止双花，如果没有这个值，那么一笔交易可以被无限重放来无限次转账（**但是，因为这个随机数是可估计的，所以我觉得也不是很安全，也有可能是签名了，所以后面改值重放就会出现问题**）
- nonce值表示的是当前已经被确认过的交易数量，值从0开始计数，假如当前已经确认过9号交易，那么我的nonce就是10，表示下一笔交易将会分配10这个编号。（**问题是，如果我一次连续发好多交易，之前的交易还没确定，怎么去给下一笔交易编号，书中给出的方案似乎是等待一段时间，毕竟以太坊打包很快，这个得确认一下。似乎又给了一个解释，这个编号可以递增的随便给，但是如果前一个编号的交易没有被确认，后面的交易就会一直阻塞，一直等待**）
- 书中提到的nonce并发的问题，以后可以研究研究，在书中的114-115页
- gas是在交易结束之后才进行结算。多退少就没了，而且交易也没完成。
- 一个交易如果与智能合约相关，就需要等合约执行完毕才能算交易完成了，不存在后台交易这件事
- 智能合约安全这块以后有时间就看一下
- 预言机为智能合约和外部世界的交互提供通道，传输带签名的数据
- 使用gas来避免停机问题，防止无限执行
- 合约的每一个运算都明码标价
- 区块验证要求gas总量不能超过限定值，该总量由矿工投票决定
- POS，出保证金来证明是对的，如果大多数人都同意则可以获得奖励，否则就失败，并损失保证金